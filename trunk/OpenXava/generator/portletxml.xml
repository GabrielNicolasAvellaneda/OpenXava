<?xml version="1.0"?>
<tl>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
<declare import="java.util.*"/>
<declare import="org.openxava.application.meta.*"/>
<declare import="org.openxava.generators.Generators"/>

&lt;!-- Generated by OpenXava: <expr>new Date()</expr> --&gt;

<java>
String applicationName = properties.getProperty("arg3");
MetaApplication application = MetaApplications.getMetaApplication(applicationName);

Collection locales = Generators.getAvailableLocales("../" + applicationName + "/i18n");
</java> 

&lt;portlet-app id="<expr>applicationName</expr>"
	xmlns="http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd" 
	version="1.0" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd"
&gt;

<java>
for (Iterator it=application.getMetaModules().iterator(); it.hasNext(); ) {
	MetaModule module = (MetaModule) it.next();
</java> 
	&lt;portlet id="<expr>module.getName()</expr>"&gt;
		&lt;description&gt;<expr>application.getLabel()</expr> - <expr>module.getDescription()</expr>&lt;/description&gt;
    <java>for (Iterator itLocales=locales.iterator(); itLocales.hasNext(); ) { 
    	Locale locale = (Locale) itLocales.next();
    </java>    
		&lt;description xml:lang="<expr>locale</expr>"&gt;<expr>application.getLabel(locale)</expr> - <expr>module.getDescription(locale)</expr>&lt;/description&gt;
	<java>} </java>       
		&lt;portlet-name&gt;<expr>module.getName()</expr>&lt;/portlet-name&gt;
		&lt;display-name&gt;<expr>application.getLabel()</expr> - <expr>module.getLabel()</expr>&lt;/display-name&gt;
    <java>for (Iterator itLocales=locales.iterator(); itLocales.hasNext(); ) { 
    	Locale locale = (Locale) itLocales.next();
    </java>    
		&lt;display-name xml:lang="<expr>locale</expr>"&gt;<expr>application.getLabel(locale)</expr> - <expr>module.getLabel(locale)</expr>&lt;/display-name&gt;
    <java>} </java> 
    <java>if (module.isDoc()) { </java> 
		&lt;portlet-class&gt;org.openxava.web.portlets.HtmlPortlet&lt;/portlet-class&gt;
		&lt;init-param&gt;
			&lt;name&gt;Page&lt;/name&gt;
			&lt;value&gt;<expr>module.getDocURL()</expr>&lt;/value&gt;
		&lt;/init-param&gt;
		&lt;init-param&gt;
			&lt;name&gt;Languages&lt;/name&gt;
			&lt;value&gt;<expr>module.getDocLanguages()</expr>&lt;/value&gt;
		&lt;/init-param&gt;		
	<java>} else { </java> 
		&lt;portlet-class&gt;org.openxava.web.portlets.XavaPortlet&lt;/portlet-class&gt;
		&lt;init-param&gt;
			&lt;name&gt;Application&lt;/name&gt;
			&lt;value&gt;<expr>applicationName</expr>&lt;/value&gt;
		&lt;/init-param&gt;
		&lt;init-param&gt;
			&lt;name&gt;Module&lt;/name&gt;
			&lt;value&gt;<expr>module.getName()</expr>&lt;/value&gt;
		&lt;/init-param&gt;			
	<java>} </java> 
		&lt;expiration-cache&gt;-1&lt;/expiration-cache&gt;
		&lt;supports&gt;
			&lt;mime-type&gt;text/html&lt;/mime-type&gt;
			&lt;portlet-mode&gt;VIEW&lt;/portlet-mode&gt;
		&lt;/supports&gt;
    <java>for (Iterator itLocales=locales.iterator(); itLocales.hasNext(); ) { </java>
		&lt;supported-locale&gt;<expr>itLocales.next()</expr>&lt;/supported-locale&gt;
    <java>} </java> 
    	&lt;resource-bundle&gt;portlets/<expr>module.getName()</expr>&lt;/resource-bundle&gt;
	&lt;/portlet&gt;
<java>
}
</java>   
	
&lt;/portlet-app&gt;
</tl>