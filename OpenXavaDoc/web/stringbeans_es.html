<h4>Integraci&oacute;n de portlets de&nbsp;OpenXava en Stringbeans
Portal</h4>
<p style="font-style: italic;">At
the moment this article is only in Spanish, if you want to contribute
to OpenXava, we encourage you to translate it to English and contribute
the translation.</p>
<br>
Aqu&iacute; tenemos algunos pantallazos de una aplicaci&oacute;n
OpenXava en el portal <a href="http://www.nabh.com/projects/sbportal">Stringbeans</a>:<br>
<ul>
  <li><a href="/OpenXavaDoc/images/stringbeans-list-screenshot.jpg">Ejemplo
de modo lista</a></li>
  <li><a href="/OpenXavaDoc/images/stringbeans-detail1-screenshot.jpg">Ejemplo
de modo detalle</a></li>
  <li><a href="/OpenXavaDoc/images/stringbeans-detail2-screenshot.jpg">Otro
ejemplo de modo detalle</a></li>
</ul>
&nbsp;<a href="http://www.nabh.com/projects/sbportal">Stringbeans</a>
es un sistema portal compatible con el estandar JSR-168 que permite
a&ntilde;adir portlets que se encuentran en otros contextos del
servidor de aplicaciones. Para ello es requisito imprescindible que
tanto el propio contexto de Stringbeans, como el que contiene los
portlets, sean accesibles declar&aacute;ndolos en <span
 style="font-weight: bold;">./conf/server.xml</span>
como <span style="font-weight: bold;">crossContext="true"</span>
. Por ejemplo:<br>
<br>
<span style="font-weight: bold;"><span
 style="text-decoration: underline;">server.xml</span><br>
<br>
</span>
<pre>&lt;Host appBase="webapps" autoDeploy="true" name="localhost"<br>	unpackWARs="true" xmlNamespaceAware="false" xmlValidation="false"&gt;<br><br>	&lt;Context path="/stringbeans"<br>		docBase="stringbeans" crossContext="true" /&gt;<br>
	&lt;Context path="/misportlets"
		docBase="misportlets" crossContext="true" /&gt;
</pre>
&nbsp;<br>
Vamos a aprovechar que estamos editando el fichero <span
 style="font-weight: bold;">server.xml</span>
para incluir <span style="font-weight: bold;">emptySessionPath="true" </span>en
la secci&oacute;n del conector. Ejemplo:<br>
<span style="font-weight: bold;"><br>
</span>
<pre>&lt;Connector<br>	acceptCount="100" connectionTimeout="20000"<br>	disableUploadTimeout="true" enableLookups="false" maxSpareThreads="75"<br>	maxThreads="150" minSpareThreads="25" port="8080" redirectPort="8443"<br>	emptySessionPath="true"/&gt;<br></pre>
Esto es necesario para que la sesi&oacute;n sea compartida entre
los contextos de Stringbeans y de nuestros portlets. Concretamente es
requisito imprescindible para la integraci&oacute;n con portlets
desarrollados con <a
 href="http://www.gestion400.com/web/guest/openxava">OpenXava</a>
y que funcionen correctamente los servlets de generaci&oacute;n de
reports PDF y CSV, ya que de otra forma no ser&iacute;an capaces de
obtener los valores del <span style="font-weight: bold;">tab</span>
y se producir&iacute;a una excepci&oacute;n.<br>
<br>
Se deben <span style="font-weight: bold;">mover</span>
los siguientes .jar de ./stringbeans/WEB-INF/lib a un repositorio
com&uacute;n de librer&iacute;as compartidas del servidor J2EE,
en el caso de Tomcat a ./common/lib<br>
<ul>
  <li>portlet.jar</li>
  <li>sb-containet.jar</li>
  <li>sb-share-common.jar</li>
</ul>
Se deben a&ntilde;adir las siguiente librer&iacute;as (de
Stringbeans) al contexto de nuestra aplicaci&oacute;n:<br>
<ul>
  <li><code>sb-portal.jar</code></li>
  <li><code>sb-common.jar</code></li>
  <li><code>sb-portlet-common.jar (desde la versi&oacute;n 3.2)</code></li>
  <li><code></code><code>jaxb-api.jar</code></li>
  <li><code>jaxb-impl.jar</code></li>
  <li><code>jaxb-libs.jar</code></li>
  <li><code>namespace.jar</code></li>
  <li><code>relaxngDatatype.jar</code></li>
  <li><code>jax-qname.jar</code></li>
  <li><code>xsdlib.jar</code></li>
</ul>
Igualmente se debe a&ntilde;adir el fichero <span
 style="font-weight: bold;">portlet.tld</span>
a un lugar que posteriormente referenciaremos en web.xml, por ejemplo
en ./WEB-INF<br>
<br>
En el fichero <span style="font-weight: bold;">web.xml</span>
del contexto de nuestra aplicaci&oacute;n, se deben
a&ntilde;adir las siguientes entradas:<br>
<br>
<pre>&lt;servlet&gt;<br> &lt;servlet-name&gt;PortletServlet&lt;/servlet-name&gt;<br> &lt;servlet-class&gt;com.nabhinc.portal.core.PortletServlet&lt;/servlet-class&gt;<br> &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;<br>&lt;/servlet&gt;<br>:<br>:<br>&lt;servlet-mapping&gt;<br> &lt;servlet-name&gt;PortletServlet&lt;/servlet-name&gt;<br> &lt;url-pattern&gt;/portlet_servlet&lt;/url-pattern&gt;<br>&lt;/servlet-mapping&gt;<br><br>&lt;taglib&gt;<br> &lt;taglib-uri&gt;http://java.sun.com/portlet&lt;/taglib-uri&gt;<br> &lt;taglib-location&gt;/WEB-INF/portlet.tld&lt;/taglib-location&gt;<br>&lt;/taglib&gt;<br><br><br>Es importante indicar que &eacute;ste servlet se cargue en el arranque (&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;)<br><br>ya que si no se carga antes que Stringbeans se producir&aacute; un error.<br><br><br></pre>
Finalmante en Stringbeans, entramos como administrador a la
secci&oacute;n de configuraci&oacute;n del portal y de
ah&iacute; a Portlet App Context. Como "Context Path" ponemos
nuestro contexto (ej: /misportlets) y como "Servlet URI" indicamos
"/portlet_servlet"<br>
<br>
Si hemos seguido correctamente todos los pasos, Stringbeans
indicar&aacute; que el contexto ha sido a&ntilde;adido
correctamente y habr&aacute; a&ntilde;adido nuestra lista de
portlets a su fichero interno de portlets, de tal manera que desde
"Portlet Admin" los veremos listados y se podr&aacute; hacer uso de
ellos.<br>
<br>
<span style="text-decoration: underline;">*Nota</span>:
Si queremos clasificar los nuestros portlets, manualmente debemos
editar el fichero portlet.xml y en cada portlet a&ntilde;adir:<br>
<br>
&lt;portlet-info&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;title&gt;Titulo del portlet&lt;/title&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;keywords&gt;Categoria&lt;/keywords&gt;<br>
&lt;/portlet-info&gt;<br>
<br>
De esta forma, posteriormente en la selecci&oacute;n de portlets
que queremos agregar a un layout, se mostrar&aacute;n ordenados por
categor&iacute;as.<br>
<br>
<pre><span style="font-weight: bold; text-decoration: underline;">Referencias<br><br></span></pre>
<ul>
  <li><a href="http://www.nabh.com/projects/sbportal">Stringbeans
Portal</a></li>
  <li><a
 href="http://www.nabh.com/doc/sb_config_ref_manual.html#portletAppContext">Despliegue
de portlets externos</a></li>
  <li><a href="http://www.nabh.com/doc/sb_config_ref_manual.html">Manual
de configuraci&oacute;n</a></li>
  <li><a href="http://www.nabh.com/doc/sb_portal_dev_guide.html">Gu&iacute;a
para el desarrollador</a></li>
  <li><a href="http://www.nabh.com/doc/sb_install_guide.html">Gu&iacute;a
de instalaci&oacute;n</a></li>
  <li><a href="http://www.nabh.com/doc/sb_install_guide.html#user_setup">Usuarios
especiales del sistema</a></li>
</ul>
<pre><span style="font-weight: bold; text-decoration: underline;"></span></pre>
