<?xml version="1.0" encoding="ISO-8859-1"?>

<project name="XDoclet" default="ejbdoclet" basedir=".">
	
	<property name="src.dir" value="gen-src-xava" />
	<property name="src.dir.2" value="src" />
	<property name="generated.src.dir" value="gen-src" />
	<property name="meta-inf.dir" value="build/ejb/META-INF"/>
	<property name="config.dir" value="../OpenXava/xdoclet/config"/>
	<property name="type-mapping" value="Hypersonic SQL"/>
	
	<path id="xdoclet.class.path">
		<fileset dir="../OpenXava/xdoclet/lib">
			<include name="*.jar"/>
		</fileset>
	</path>	

	<target name="init">
		<tstamp>
			<format property="TODAY" pattern="d-MM-yy"/>
		</tstamp>
		<taskdef
			name="ejbdoclet"
			classname="xdoclet.modules.ejb.EjbDocletTask"
			classpathref="xdoclet.class.path"
		/>
	</target>

	<target name="ejbdoclet" depends="init">
		<ejbdoclet
			destdir="../${project}/${generated.src.dir}"
			excludedtags="@version,@author,@todo"
			ejbspec="2.0"
			verbose="false">
            
			<fileset dir="../${project}/${src.dir}">
      	<include name="${domain}/${package}/${ejb.package}/xejb/*Bean.java" />
			</fileset>
       
			<fileset dir="../${project}/${src.dir.2}">
      	<include name="${domain}/${package}/${ejb.package}/xejb/*Bean.java" />
			</fileset>
       
			<packageSubstitution packages="${ejb.package}.xejb" substituteWith="${ejb.package}"/>
        
			<remoteinterface/>            
			<homeinterface/>
			<valueobject  generatePKConstructor="true"/>
			<dataobject/>
			<entitypk pattern="{0}Key"/>
			<entitycmp/>
			<utilobject cacheHomes="true" kind="physical"/> 
            
			<deploymentdescriptor 
				xmlencoding="ISO-8859-1"         
        destdir="${meta-inf.dir}" 
        validatexml="true" 
        mergedir="${config.dir}/ejb"
       />
        
			<jboss
				version="3.2"
				typemapping="${type-mapping}"
				datasource="java:/@datasource@"				
				unauthenticatedPrincipal="nobody"
				xmlencoding="ISO-8859-1"
				destdir="${meta-inf.dir}"
				validatexml="true"
				mergeDir="${config.dir}/jboss"
				preferredrelationmapping="relation-table"
			/>
			
			<websphere destdir="${meta-inf.dir}"/>

      </ejbdoclet>

    </target>

</project>
